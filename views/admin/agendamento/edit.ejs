<%- include('../../partials/header') %>
<%- include('../../partials/navbar') %>

<div class="container mt-4">
    <h2>Editar Agendamento</h2>

    <% if (messages.error) { %>
        <div class="alert alert-danger"><%= messages.error %></div>
    <% } %>

    <form action="/agendamentos/update" method="POST" class="mb-4">
        <input type="hidden" name="id" value="<%= agendamento.id %>">
        
        <div class="form-group">
            <label for="userId">ID do Usu√°rio</label>
            <input type="text" class="form-control" id="userId" name="userId" value="<%= agendamento.userId %>" required>
        </div>

        <div class="form-group">
            <label for="petId">Pet</label>
            <select class="form-control" id="petId" name="petId" required>
                <option value="">Selecione um pet...</option>
                <% pets.forEach(pet => { %>
                    <option value="<%= pet.id %>" <%= agendamento.petId === pet.id ? 'selected' : '' %>>
                        <%= pet.nome %>
                    </option>
                <% }) %>
            </select>
        </div>

        <div class="form-group">
            <label for="data">Data da Visita</label>
            <input type="date" class="form-control" id="data" name="data" 
                value="<%= new Date(agendamento.data).toISOString().split('T')[0] %>" required>
        </div>

        <div class="form-group">
            <label for="hora">Hora da Visita</label>
            <input type="time" class="form-control" id="hora" name="hora" 
                value="<%= agendamento.hora %>" required>
        </div>

        <div class="form-group">
            <label for="status">Status</label>
            <select class="form-control" id="status" name="status" required>
                <option value="pendente" <%= agendamento.status === 'pendente' ? 'selected' : '' %>>Pendente</option>
                <option value="confirmado" <%= agendamento.status === 'confirmado' ? 'selected' : '' %>>Confirmado</option>
                <option value="cancelado" <%= agendamento.status === 'cancelado' ? 'selected' : '' %>>Cancelado</option>
            </select>
        </div>

        <button type="submit" class="btn btn-primary">Atualizar</button>
        <a href="/admin/agendamentos" class="btn btn-secondary">Cancelar</a>
    </form>
</div>

<%- include('../../partials/footer') %>